mport React, { useState } from 'react';
import { Table, Button } from 'antd';

const App = () => {
  // Initialize table data with a 'priority' field
  const [dataSource, setDataSource] = useState([
    { key: '1', name: 'John Brown', age: 32, priority: 1 },
    { key: '2', name: 'Jim Green', age: 42, priority: 2 },
    { key: '3', name: 'Joe Black', age: 29, priority: 3 },
  ]);

  // Function to include/exclude a row based on priority
  const handleIncludeExclude = (key, include) => {
    setDataSource((prevData) => {
      // Find the maximum priority currently in the data
      let maxPriority = Math.max(...prevData.map(item => item.priority));

      return prevData
        .map((item) => {
          if (item.key === key) {
            if (include) {
              // If we are including, assign the next highest priority (maxPriority + 1)
              return { ...item, priority: maxPriority + 1 };
            } else {
              // If excluding, reset priority to 0 and adjust other priorities
              let itemPriority = item.priority;
              return { ...item, priority: 0 };
            }
          } else if (item.priority > 0 && item.priority > prevData.find(row => row.key === key).priority) {
            // Decrease the priority of all rows with a higher priority than the excluded row
            return { ...item, priority: item.priority - 1 };
          }
          return item;
        })
        // Sort data by priority in ascending order, placing priority 0 at the bottom
        .sort((a, b) => {
          if (a.priority === 0) return 1; // Always push rows with priority 0 to the bottom
          if (b.priority === 0) return -1;
          return a.priority - b.priority; // Sort by ascending priority
        });
    });
  };

  // Define table columns
  const columns = [
    {
      title: 'Name',
      dataIndex: 'name',
      key: 'name',
    },
    {
      title: 'Age',
      dataIndex: 'age',
      key: 'age',
    },
    {
      title: 'Priority',
      dataIndex: 'priority',
      key: 'priority',
    },
    {
      title: 'Action',
      key: 'action',
      render: (_, record) => (
        <span>
          <Button
            onClick={() => handleIncludeExclude(record.key, true)}
            disabled={record.priority > 0}
          >
            Include
          </Button>
          <Button
            onClick={() => handleIncludeExclude(record.key, false)}
            style={{ marginLeft: 8 }}
            disabled={record.priority === 0}
          >
            Exclude
          </Button>
        </span>
      ),
    },
  ];

  return (
    <Table
      dataSource={dataSource}
      columns={columns}
      rowKey="key"
      pagination={false} // Optional: to show all rows without pagination
    />
  );
};

export default App;
